@page "/account/add"
@page "/account/edit/{Username}"

<div class="page-header text-align-center">
    @TextResources.APP_StringKeys_Account_AddUser
</div>
<div class="pages-user-add text-align-center"
     style="margin-top:50px">
    @if (IsMessageShown)
    {
        <MudAlert Severity="AlertSeverity"
                  Variant="Variant.Filled"
                  Class="rounded-0"
                  ShowCloseIcon="true"
                  CloseIconClicked="()=> IsMessageShown = false">
            <ul>
                @foreach (var text in MessageTexts)
                {
                    <li>
                        @text
                    </li>
                }
            </ul>
        </MudAlert>
    }
    <EditForm Model="Command"
              OnValidSubmit="OnValidSubmit"
              OnInvalidSubmit="OnInvalidSubmit">
        <DataAnnotationsValidator />
        <div class="form-group">
            <MudTextField @bind-Value="Command.Username"
                          Label="@TextResources.APP_StringKeys_Account_Username"
                          Variant="Variant.Outlined"
                          Margin="Margin.Dense"
                          ReadOnly="@(Username is not null)">
            </MudTextField>
        </div>
        <div class="form-group">
            <MudTextField @bind-Value="Command.PersianName"
                          Label="@TextResources.APP_StringKeys_Account_PersianName"
                          Variant="Variant.Outlined"
                          Margin="Margin.Dense">
            </MudTextField>
        </div>
        <div class="form-group">
            <MudSelect @bind-Value="Command.ParentId"
                       Label="@TextResources.APP_StringKeys_User_Parent"
                       Variant="Variant.Outlined"
                       Margin="Margin.Dense">
                @foreach (var user in Users)
                {
                    <MudSelectItem Value="@user.Id">@user.PersianName</MudSelectItem>
                }
            </MudSelect>
        </div>
        <div class="form-group">
            <MudSelect @bind-Value="Command.DepartmentId"
                       Label="@TextResources.APP_StringKeys_Department"
                       Variant="Variant.Outlined"
                       Margin="Margin.Dense">
                @foreach (var department in Departments)
                {
                    <MudSelectItem Value="@department.Id">@department.Name</MudSelectItem>
                }
            </MudSelect>
        </div>
        <div class="form-group">
            <MudSelect @bind-Value="Command.RoleId"
                       Label="@TextResources.APP_StringKeys_Role"
                       Variant="Variant.Outlined"
                       Margin="Margin.Dense">
                @foreach (var role in Roles)
                {
                    <MudSelectItem Value="@role.Id">@role.NormalizedName</MudSelectItem>
                }
            </MudSelect>
        </div>
        <div class="form-group">
            <MudTextField @bind-Value="Command.Password"
                          Label="@TextResources.APP_StringKeys_Account_Password"
                          Variant="Variant.Outlined"
                          Margin="Margin.Dense">
            </MudTextField>
        </div>
        <button type="submit"
                class="btn btn-primary page-floating-button-bottom">
            <MaterialIcon IconName="@MaterialIconsHelper.Save"></MaterialIcon>
        </button>
    </EditForm>
</div>